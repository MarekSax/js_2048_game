const t=new class{constructor(t=this.#t()){this.initialState=t,this.state=this.initialState.map(t=>[...t]),this.score=0,this.status="idle"}moveLeft(){if("playing"===this.status){let t=this.state.map(t=>this.#e(t));this.#s(t)}}moveRight(){if("playing"===this.status){let t=this.state.map(t=>{let e=t.slice().reverse();return this.#e(e).reverse()});this.#s(t)}}moveUp(){if("playing"===this.status){let t=this.#a(this.state).map(t=>this.#e(t));this.#s(this.#a(t))}}moveDown(){if("playing"===this.status){let t=this.#a(this.state).map(t=>{let e=t.slice().reverse();return this.#e(e).reverse()});this.#s(this.#a(t))}}getScore(){return this.score}getState(){return this.state}getStatus(){return this.status}start(){this.status="playing",this.#i(),this.#i()}restart(){this.state=this.initialState.map(t=>[...t]),this.score=0,this.status="idle"}#t(){return Array.from({length:4},()=>[,,,,].fill(0))}#r(){let t=[];return this.state.forEach((e,s)=>{e.forEach((e,a)=>{0===e&&t.push({rowIndex:s,cellIndex:a})})}),t}#i(){let t=this.#r();if(0===t.length)return;let e=t[Math.floor(Math.random()*t.length)];this.state[e.rowIndex][e.cellIndex]=Math.random()>.1?2:4}#e(t){let e=t.filter(t=>0!==t),s=[],a=0;for(;a<e.length;)e[a]===e[a+1]?(s.push(2*e[a]),this.score+=2*e[a],a+=2):(s.push(e[a]),a+=1);return s.push(...Array(4-s.length).fill(0)),s}#a(t){return t[0].map((e,s)=>t.map(t=>t[s]))}#n(t){return JSON.stringify(this.state)!==JSON.stringify(t)}#l(){this.status=this.state.some(t=>t.includes(2048))?"win":this.status}#o(){for(let t of this.state){if(t.some(t=>0===t))return!1;for(let e=0;e<t.length;e++)if(t[e]===t[e+1])return!1}for(let t=0;t<4;t++){let e=[this.state[0][t],this.state[1][t],this.state[2][t],this.state[3][t]];for(let t=0;t<e.length;t++)if(e[t]===e[t+1])return!1}return!0}#s(t){this.#n(t)&&(this.state=t,this.#i(),this.#l(),this.#o()&&(this.status="lose"))}},e=document.querySelector(".button",".start");function s(){let e=t.getState(),s=document.querySelector(".game-field").querySelector("tbody");s.innerHTML="";for(let t=0;t<e.length;t++){let a=e[t],i=document.createElement("tr");i.className="field-row";for(let t=0;t<a.length;t++){let e=a[t],s=document.createElement("td");s.textContent=0!==e?e:"",s.className=0!==e?`field-cell field-cell--${e}`:"field-cell",i.appendChild(s)}s.appendChild(i)}}function a(){document.querySelector(".game-score").innerText=t.getScore()}function i(t,e){let s=document.querySelector(".message-start"),a=document.querySelector(".message-win"),i=document.querySelector(".message-lose");if("hide"===t)switch(e){case"start":s.classList.add("hidden");break;case"win":a.classList.add("hidden");break;case"lose":i.classList.add("hidden")}if("show"===t)switch(e){case"start":s.classList.remove("hidden");break;case"win":a.classList.remove("hidden");break;case"lose":i.classList.remove("hidden")}}function r(){s(),a(),function(){switch(t.getStatus()){case"win":i("show","win");break;case"lose":i("show","lose")}}()}e.addEventListener("click",()=>{switch(t.getStatus()){case"idle":t.start(),s(),e.className="button restart",e.textContent="Restart",i("hide","start"),a();break;case"playing":t.restart(),s(),e.className="button start",e.textContent="Start",i("show","start"),a();break;case"win":t.restart(),s(),e.className="button start",e.textContent="Start",i("hide","win"),i("show","start"),a();break;case"lose":t.restart(),s(),e.className="button start",e.textContent="Start",i("hide","lose"),i("show","start"),a()}}),document.addEventListener("keydown",e=>{switch(e.key){case"ArrowLeft":t.moveLeft(),r();break;case"ArrowRight":t.moveRight(),r();break;case"ArrowUp":t.moveUp(),r();break;case"ArrowDown":t.moveDown(),r()}});
//# sourceMappingURL=index.e99d90ef.js.map
